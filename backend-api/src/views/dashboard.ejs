<%# backend-api/src/views/dashboard.ejs %>

<%# Variabel ini akan digunakan oleh admin_layout.ejs %>
<% locals.title = "Dashboard"; %>
<% locals.pageHeading = "Dashboard Utama"; %>
<% locals.currentPath = "/admin/dashboard"; %>

<div class="row">
    <div class="col-xl-3 col-md-6 mb-4">
        </div>
    <div class="col-xl-3 col-md-6 mb-4">
        </div>
</div>

<div class="row">
    <div class="col-lg-12">
        <p>Selamat datang di panel admin Photobooth! Gunakan menu di samping untuk navigasi dan mengelola aplikasi.</p>
    </div>
</div>

<hr class="my-4"> <%# Pemisah %>

<div class="row">
    <div class="col-lg-12">
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">Informasi Debug Cookie (dari Server)</h6>
            </div>
            <div class="card-body">
                <p>Klik tombol di bawah untuk meminta server menampilkan cookie yang diterimanya untuk sesi ini.</p>
                <button id="checkServerCookiesButton" class="btn btn-warning">Cek Cookie yang Diterima Server</button>
                <div id="serverCookieInfo" class="mt-3" style="white-space: pre-wrap; background-color: #f8f9fc; border: 1px solid #e3e6f0; padding: 15px; border-radius: .35rem; display: none; max-height: 400px; overflow-y: auto;">
                    <p>Memuat...</p>
                </div>
            </div>
        </div>
    </div>
</div>

<%# Menambahkan skrip untuk tombol debug ke dalam blok page_custom_scripts %>
<%
let existingScripts = locals.page_custom_scripts || "";
locals.page_custom_scripts = existingScripts + `
<script>
    // Pastikan DOM sudah siap sebelum memasang listener
    document.addEventListener('DOMContentLoaded', () => {
        const checkServerCookiesButton = document.getElementById('checkServerCookiesButton');
        const serverCookieInfoDiv = document.getElementById('serverCookieInfo');

        console.log('DEBUG: Tombol Cek Cookie ditemukan?', checkServerCookiesButton); // Tambahkan log ini
        console.log('DEBUG: Div Info Cookie ditemukan?', serverCookieInfoDiv); // Tambahkan log ini

        if (checkServerCookiesButton && serverCookieInfoDiv) { // Tambahkan pengecekan null
            checkServerCookiesButton.addEventListener('click', async () => {
                console.log('DEBUG: Tombol Cek Cookie DIKLIK!'); // Tambahkan log ini
                serverCookieInfoDiv.style.display = 'block';
                serverCookieInfoDiv.textContent = 'Meminta data ke server...';
                try {
                    // ... (sisa kode fetch seperti sebelumnya) ...
                    const response = await fetch('/api/debug/check-cookies', { /* ... */ });
                    const data = await response.json();
                    console.log('DEBUG: Respons dari /api/debug/check-cookies:', data); // Tambahkan log ini
                    if (response.ok) {
                        serverCookieInfoDiv.textContent = JSON.stringify(data, null, 2);
                    } else {
                        // ... (error handling)
                    }
                } catch (error) {
                    // ... (error handling)
                }
            });
        } else {
            console.error('DEBUG: Tombol atau Div Info Cookie tidak ditemukan di DOM.');
        }
    });
</script>
`;
%>